extends ../share/layout
block content
    div.container
        div#title
            h3 #{title}
                h4 #{error}
        form(name="newRoom",method="post",action=action )
            p Room Name
            input(type="text", placeholder="New Room", name="title" value=room.title)
            p Description
            input(type="text", placeholder="Welcome to my room", name="description" value=room.description)
            p Type:
                - var myType = [];
                if room.room_type === "Public"
                   - myType = ["Public", "Private"];
                else
                   - myType = ["Private", "Public"];
                select(style="display:block;" name="room_type")
                    each val, index in myType
                        option(value=val) #{val}
            p Room Config:
                - var myType = configs;
                - var optionList
                - var valueList
                - var listAsset
                if room.room_config
                    - valueList = [room.room_config._id];
                    - optionList = [room.room_config.title];
                    - listAsset = [room.room_config];
                    each val in myType
                        if val._id.toString() !== room.room_config._id.toString()
                            - valueList.push(val._id);
                            - optionList.push(val.title);
                            - listAsset.push(val);
                else
                    - optionList = [ null ];
                    - valueList = [ null ];
                    - listAsset = [ null ];
                    each val in myType
                        - valueList.push(val._id);
                        - optionList.push(val.title);
                        - listAsset.push(val);

                select#id(style="display:block;" name="room_config")
                    - for(var i =0; i <= valueList.length -1; i++)
                        option(label=optionList[i], type="text", value=valueList[i]) #{ listAsset[i] }
                div Your Selected Config Information:
                div Title is:
                    div#idText(style="color: blue") empty
                div Description is:
                    div#idDescription(style="color: blue") empty
                div full detail:
                    div#idFullDetail(style="color: blue") empty
                script.
                    var templocal = !{JSON.stringify(room)};
                    var e = document.getElementById("id");
                    s = e.options[e.selectedIndex].value;
                    v = e.options[e.selectedIndex].label;
                    //console.log(v);
                    j = e.options[e.selectedIndex].text;
                    console.log(j);
                    if(templocal === null) {
                        $('#idText').text(templocal.room_config.title);
                        $('#idDescription').text(templocal.room_config.description);
                        $('#idFullDetail').text(JSON.stringify(templocal.room_config));
                    }
                    function hello(){
                        console.log("----------------");
                        //console.log(val);
                    }
                    //console.log(s);
                    e.onchange = function() {
                        s = e.options[e.selectedIndex].value;
                        //console.log(s);
                        v = e.options[e.selectedIndex].label;
                        //console.log(v);
                        j = e.options[e.selectedIndex].text;
                        //console.log(j);
                        var temp = !{JSON.stringify(configs)};
                        var index = temp.findIndex(function (item, i){
                            return item._id === s;
                        });
                        if(index === -1){
                            $('#idText').text("empty");
                            $('#idDescription').text("empty");
                            $('#idFullDetail').text("empty");
                        }else {
                            $('#idText').text(temp[index].title);
                            $('#idDescription').text(temp[index].description);
                            $('#idFullDetail').text(JSON.stringify(temp[index]));
                            //console.log(index);
                        }
                    }
            div#formButton
                button.btn(type="submit") submit
                a(href="/user/room")
                    button.btn#cancelButton(type="button") Cancel
